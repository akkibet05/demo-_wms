<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head'); -%>
    <style>
        /* .cv-tbl tr,td,th{
            border: 1px solid;
            width: 200%;
        } */

        .cv-tbl td{
            border: 1px solid;
            /* width: 100%; */
        }
        
        .center {
          text-align: center;
        }
        
        
        .table-responsive {
            overflow-x: scroll;
            /* max-width: 100%; */
        }
        
        .vertical-text {
            writing-mode: vertical-lr;
            text-orientation: sideways;
        }
    </style>
</head>

<body>
    <!--*******************
    Preloader start
********************-->
    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>
    <!--*******************
    Preloader end
********************-->

    <!--**********************************
    Main wrapper start
***********************************-->
    <div id="main-wrapper">

        <!--**********************************
        Nav header start
    ***********************************-->
        <%- include('./partials/header_logo'); -%>

            <!--**********************************
        Nav header end
    ***********************************-->

            <!--**********************************
        Header start
    ***********************************-->
            <%- include('./partials/header',{titel: language.WareHouse_Map}); -%>

                <!--**********************************
        Header end ti-comment-alt
    ***********************************-->

                <!--**********************************
        Sidebar start
    ***********************************-->
                <%- include('./partials/sidebar'); -%>

                    <!--**********************************
        Sidebar end
    ***********************************-->

                    <div class="content-body">
                        <div class="card">
                            <div class="container-fluid">
                                <div class="card-header">
                                            <h4 class="card-title">Warehouse Map</h4>
                                             
                                         
                                </div>
                                
                                <div class="card-header" style="display: flex; flex-direction: column; align-items: center;">
                                <div class="row">
                                    <div class="mb-3 col-md-4">
                                        <label for="warrehouse">Warehouse <span class="text-red">*</span> </label>
                                        <select class="form-control" name="warehouse" id="warehouse" required>
                                           
                                            <% warehouse.forEach((data)=> { %>
                                            <option value="<%= data.name %>"><%= data.name %></option>
                                            <% }) %>
                                        </select>
                                    </div>
                                    
                                    
                                    <div class="mb-3 col-md-4">
                                        <label for="warrehouse">Room <span class="text-red">*</span> </label>
                                        <select class="form-control" name="room" id="room" required>
                                            <option value="Ambient" >Ambient</option>
                                            <option value="Enclosed" >Enclosed</option>
                                        </select>
                                    </div>
                                    
                                  
                                    <div class="mb-3 col-md-4">
                                        <label for="warrehouse">Level <span class="text-red">*</span> </label>
                                        <select class="form-control" name="level" id="level" required>
                                        
                                            <option value="1" >One</option>
                                            <option value="2" >Two</option>
                                            <option value="3" >Three</option>
                                            <option value="4" >Four</option>
                                        </select>
                                    </div>


                                    <!-- <div class="mb-3 col-md-3">
                                        <label for="warrehouse">Isle <span class="text-red">*</span> </label>
                                        <select class="form-control" name="isle" id="isle" required>
                                            <option value="ALL" >All</option>
                                            <option value="A" >A</option>
                                            <option value="B" >B</option>
                                            <option value="C" >C</option>
                                            <option value="D" >D</option>
                                        </select>
                                    </div> -->
                                    



                                </div> 
                                
                                <div class="row">
                                    <button type="submit" class="btn btn-primary w-100" id="filterButton">Generate</button>
                                </div> 
                            </div>
                            
                           <!--<div class="container-fluid"> -->
                           <!--     <table id="dataTable" border="1" style="border-collapse: collapse;" class="cv-tbl table-responsive">-->
                           <!--         <tbody>-->
                                        
                           <!--         </tbody>-->
                           <!--     </table>-->
                           <!-- </div>-->
                           
                           <div class="container-fluid">
                            <div class="table-responsive">
                                <table id="dataTable" class="cv-tbl">
                                    <tbody>
                                   
                                    </tbody>
                                </table>
                            </div>
                        </div>

                           </div>
                       </div>
                    </div>

                    <!--**********************************
            Footer start
        ***********************************-->
                    <%- include('./partials/footer'); -%>

                        <!--**********************************
            Footer end
        ***********************************-->

    <!--**********************************
        Main wrapper end
    ***********************************-->

    <!-- start Toastr -->
    <%- include('./partials/toastr'); -%>
    <!-- End Toastr -->

    <!--**********************************
        Scripts
    ***********************************-->
   
    <%- include('./partials/script'); -%>
    <script>
      function jsonToArray(jsonData) {
        var data = [];

        jsonData.forEach((item) => {
          var isle = item._id.isle;
          var pallet = parseInt(item._id.pallet);
          var count = item.count;
        if (!data[isle]) {
            data[isle] = {};
          }
          data[isle][pallet] = count;
          data[isle]['pallet'] = pallet;
          
        });

        return data;
      }


      $(document).ready(function() {
  // Initialize the DataTable
  dataBody = $('#dataTable tbody');

  // Event handler for the filter button click
  $('#filterButton').click(function() {
    var warehouse_value = $('#warehouse').val();
    var level_value = parseInt($('#level').val());
    var room_value = $('#room').val();
    var isle_value = $('#isle').val();
    

    // Make an AJAX request to the server
    $.ajax({
      url: '/warehousemap_Income/MapData',
      type: 'POST',
      data: { warehouseNew: warehouse_value, level: level_value, rooms: room_value },
      success: function(response) {
        // Clear the existing table data
        dataBody.empty();
        
        const DataRes = jsonToArray(response);
        let dataIsle 
        let dataIsleHalf
        isle_value = "ALL"
        if(isle_value == "ALL"){
          dataIsle = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J"];
          dataIsleHalf = ["G", "H", "I", "J"];
        }else{
          dataIsle = [isle_value];
          dataIsleHalf = [isle_value];
        }
        
        switch(warehouse_value) {
            case "Pasig":
                if(room_value == "Ambient"){
                    if(level_value == "1"){
                        
                        let j = 1;
                        let k = 54;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {

                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                             
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });
            
                    }
            
                    if(level_value == "2"){
                        let j = 477;
                        let k = 531;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });
                    }
            
                    if(level_value == "3"){
                        
                        
                        let j = 953;
                        let k = 1007;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });
                    }
            
                    if(level_value == "4"){
                            let j = 1429;
                            let k = 1483;
                            
                            
                            dataIsle.forEach(function(isleItem) {
                              var dataItems = '';
                              const IsleData = isleItem;
                            
                              dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                            
                              let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                            
                              for (let i = j; i < j + columnCount; i++) {
                                dataItems += '<td>' + i + '</td>';
                              }
                            
                              dataItems += '</tr><tr>';
                            
                              for (let i = j; i < j + columnCount; i++) {
                                if (DataRes[IsleData] && DataRes[IsleData][i]) {
                                  // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                                  if(DataRes[IsleData][i] >= 500){
                                    dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                                  }else if(DataRes[IsleData][i] >= 250){
                                    dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                                  }else{
                                    dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                                  }
                                } else {
                                  dataItems += '<td>&nbsp;</td>';
                                }
                              }
                            
                              dataItems += '</tr><tr style="height: 5px;">';
                            
                              for (let i = j; i < j + columnCount; i++) {
                                dataItems += '<td>&nbsp;</td>';
                              }
                            
                              j += columnCount; // Update j based on the range
                            
                              dataItems += "</tr>";
                            
                              dataBody.append(dataItems);
                            });
                        }
                }else if(room_value == "Enclosed"){
                    if(level_value == "1"){
                        
                        let j = 1;
                        let k = 13;
                        dataIsleHalf.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'H' && isleItem <= 'J') ? 14 : 13;
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });
            
                    }
                    
                    if(level_value == "2"){
                        
                        let j = 56;
                        let k = 68;
                        dataIsleHalf.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'H' && isleItem <= 'J') ? 14 : 13;
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });
            
                    }
                    
                    if(level_value == "3"){
                        
                        let j = 111;
                        let k = 123;
                        dataIsleHalf.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'H' && isleItem <= 'J') ? 14 : 13;
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });
            
                    }
                    
                    if(level_value == "4"){
                        
                        let j = 166;
                        let k = 178;
                        dataIsleHalf.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'H' && isleItem <= 'J') ? 14 : 13;
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });
            
                    }
                }
            break
            
            case "Iloilo":
                if(room_value == "Ambient"){
                   if(level_value == "1"){
                        
                        let j = 1;
                        let k = 54;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                          columnCount = Math.min(columnCount, 145 - j + 1); // Limit columnCount to remaining pallets
                        
                          if (j > 145) {
                            return; // Skip rendering the remaining letters if j exceeds 145
                          }
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });

            
                    } 
                }
            break
            
            case "Bacolod":
                
                if(room_value == "Ambient"){
                   if(level_value == "1"){
                        
                        let j = 1;
                        let k = 54;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                          columnCount = Math.min(columnCount, 60 - j + 1); // Limit columnCount to remaining pallets
                        
                          if (j > 60) {
                            return; // Skip rendering the remaining letters if j exceeds 145
                          }
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });

            
                    } 
                }
            break
            
            case "Cebu":
                
                if(room_value == "Ambient"){
                   if(level_value == "1"){
                        
                        let j = 1;
                        let k = 54;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                          columnCount = Math.min(columnCount, 150 - j + 1); // Limit columnCount to remaining pallets
                        
                          if (j > 150) {
                            return; // Skip rendering the remaining letters if j exceeds 145
                          }
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });

            
                    } 
                }
                
                
            break
            
            case "Tacloban":
                
                if(room_value == "Ambient"){
                   if(level_value == "1"){
                        
                        let j = 1;
                        let k = 54;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                          columnCount = Math.min(columnCount, 94 - j + 1); // Limit columnCount to remaining pallets
                        
                          if (j > 94) {
                            return; // Skip rendering the remaining letters if j exceeds 145
                          }
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });

            
                    } 
                }
                
                
            break
            
            case "Davao":
                if(room_value == "Ambient"){
                   if(level_value == "1"){
                        
                        let j = 1;
                        let k = 54;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                          columnCount = Math.min(columnCount, 150 - j + 1); // Limit columnCount to remaining pallets
                        
                          if (j > 150) {
                            return; // Skip rendering the remaining letters if j exceeds 145
                          }
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });

            
                    } 
                }
                
                
            break
            
            case "CDO":
                if(room_value == "Ambient"){
                   if(level_value == "1"){
                        
                        let j = 1;
                        let k = 54;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                          columnCount = Math.min(columnCount, 200 - j + 1); // Limit columnCount to remaining pallets
                        
                          if (j > 200) {
                            return; // Skip rendering the remaining letters if j exceeds 145
                          }
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });

            
                    } 
                }
            break

            case "Zamboanga":
                if(room_value == "Ambient"){
                   if(level_value == "1"){
                        
                        let j = 1;
                        let k = 54;
                        
                        dataIsle.forEach(function(isleItem) {
                          var dataItems = '';
                          const IsleData = isleItem;
                        
                          dataItems = '<tr><td rowspan="4"><strong>' + isleItem + '</strong></td></tr>';
                        
                          let columnCount = (isleItem >= 'G' && isleItem <= 'J') ? 38 : 54;
                          columnCount = Math.min(columnCount, 50 - j + 1); // Limit columnCount to remaining pallets
                        
                          if (j > 50) {
                            return; // Skip rendering the remaining letters if j exceeds 145
                          }
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>' + i + '</td>';
                          }
                        
                          dataItems += '</tr><tr>';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            if (DataRes[IsleData] && DataRes[IsleData][i]) {
                              // dataItems += '<td class="center vertical-text"><b>' + DataRes[IsleData][i] + '</b></td>';
                              if(DataRes[IsleData][i] >= 500){
                                dataItems += '<td class="center vertical-text" bgcolor="Tomato"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else if(DataRes[IsleData][i] >= 250){
                                dataItems += '<td class="center vertical-text" bgcolor="yellow"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }else{
                                dataItems += '<td class="center vertical-text" bgcolor="white"><b style="color:black">' + DataRes[IsleData][i] + '</b></td>';
                              }
                            } else {
                              dataItems += '<td>&nbsp;</td>';
                            }
                          }
                        
                          dataItems += '</tr><tr style="height: 5px;">';
                        
                          for (let i = j; i < j + columnCount; i++) {
                            dataItems += '<td>&nbsp;</td>';
                          }
                        
                          j += columnCount; // Update j based on the range
                        
                          dataItems += "</tr>";
                        
                          dataBody.append(dataItems);
                        });

            
                    } 
                }
            break
        }
        
        
        
      },
      error: function(error) {
        console.log('Error:', error);
      }
    });
  });
});



      
    </script>

        <!--**********************************
        Scripts end
    ***********************************-->
</body>

</html>